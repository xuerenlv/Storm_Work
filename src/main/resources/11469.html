<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-hans" version="XHTML+RDFa 1.0" dir="ltr">

<!-- baidu analysis -->
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?99342548082478971a3664f7f07af374";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>

<head profile="http://www.w3.org/1999/xhtml/vocab">
  <meta property="qc:admins" content="2337225027611676166375" />
  <meta property="wb:webmaster" content="038857d6bb7aaf19" />
  <meta property="wb:webmaster" content="e8edf2229cf1b28e" />
  <script src="http://tjs.sjs.sinajs.cn/open/api/js/wb.js" type="text/javascript" charset="utf-8"></script>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="dns-prefetch" href="//cdn.qingfan.com" />
<meta http-equiv="x-dns-prefetch-control" content="on" />
<link rel="shortcut icon" href="http://cdn.qingfan.com/sites/all/themes/sharp_v3/favicon.ico" type="image/vnd.microsoft.icon" />
<meta name="description" content="摘要：随着数据体积的越来越大，实时处理成为了许多机构需要面对的首要挑战。Shruthi Kumar和Siddharth Patankar在Dr.Dobb’s上结合了汽车超速监视，为我们演示了使用Storm进行实时大数据分析。CSDN在此编译、整理。" />
<meta name="generator" content="Drupal 7 (http://drupal.org)" />
<link rel="canonical" href="http://www.qingfan.com/zh/node/11469" />
<link rel="shortlink" href="http://www.qingfan.com/zh/node/11469" />
  <title>使用Storm实现实时大数据分析 | 清帆远航</title>
  <!-- <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" /> -->
  <link type="text/css" rel="stylesheet" href="http://cdn.qingfan.com/sites/default/files/cdn/css/http/css_GD2kkmtxqfJQVVYgn0hmBSbpCV5NT_HKiiZ8MLrKTxA.css" media="all" />
<link type="text/css" rel="stylesheet" href="http://cdn.qingfan.com/sites/default/files/cdn/css/http/css_99Z8NnRclneq4VHth3MnTJOVndKW42P873Ub-6k0ITM.css" media="all" />
<link type="text/css" rel="stylesheet" href="http://cdn.qingfan.com/sites/default/files/cdn/css/http/css_xr4Y91EiVWZTn1OpyZnhIDUFxjczDUCOfskkKCO3Z9Q.css" media="all" />
<link type="text/css" rel="stylesheet" href="http://cdn.qingfan.com/sites/default/files/cdn/css/http/css_AEYuNR1DkA2nrmJQrkx1wN35GJF36ERPLGqwkJtM45Y.css" media="all" />
  <script type="text/javascript" src="http://cdn.qingfan.com/sites/default/files/js/js_BZg21BmXYMrfPmuI0wQsfBEeLNLS4uxbHohyYi1tm6A.js"></script>
<script type="text/javascript" src="http://cdn.qingfan.com/sites/default/files/js/js_W-FWD6AlM8AA5bugOtFCl3GHByeWFa_Z1zalRw02iGs.js"></script>
<script type="text/javascript" src="http://cdn.qingfan.com/sites/default/files/js/js_SjHhJ842EdMI0wRfeKfxWyAX9aCyi5ldrHj4rw2lFcg.js"></script>
<script type="text/javascript">
<!--//--><![CDATA[//><!--
jQuery.extend(Drupal.settings, {"basePath":"\/","pathPrefix":"zh\/","ajaxPageState":{"theme":"sharp_v3","theme_token":"jrdjyCzDwQn0KpUSSHDygOPpDJ-mG6K9hMc42cCYVlE","js":{"sites\/all\/modules\/contrib\/jquery_update\/replace\/jquery\/1.9\/jquery.min.js":1,"misc\/jquery.once.js":1,"misc\/drupal.js":1,"public:\/\/languages\/zh-hans_XgJbkAWf0RTELt9B61gl99uVwVFIVMt1y5jA1MyZj6g.js":1,"sites\/all\/modules\/contrib\/ueditor\/ueditor.js":1,"sites\/all\/themes\/sharp_v3\/js\/bootstrap.js":1,"sites\/all\/themes\/sharp_v3\/js\/circle-progress.js":1,"sites\/all\/themes\/sharp_v3\/js\/qingfan.js":1,"sites\/all\/themes\/sharp_v3\/js\/script.js":1,"sites\/all\/themes\/sharp_v3\/js\/jquery.qrcode.min.js":1},"css":{"modules\/system\/system.base.css":1,"modules\/system\/system.menus.css":1,"modules\/system\/system.messages.css":1,"modules\/system\/system.theme.css":1,"sites\/all\/modules\/contrib\/date\/date_api\/date.css":1,"sites\/all\/modules\/contrib\/date\/date_popup\/themes\/datepicker.1.7.css":1,"modules\/field\/theme\/field.css":1,"modules\/node\/node.css":1,"sites\/all\/modules\/contrib_changed\/quiz\/quiz.css":1,"modules\/user\/user.css":1,"sites\/all\/modules\/contrib\/workflow\/workflow_admin_ui\/workflow_admin_ui.css":1,"sites\/all\/modules\/contrib\/views\/css\/views.css":1,"sites\/all\/modules\/contrib\/ctools\/css\/ctools.css":1,"sites\/all\/modules\/contrib\/ueditor\/ueditor\/themes\/default\/ueditor.css":1,"sites\/all\/themes\/sharp_v3\/css\/style.css":1,"sites\/all\/themes\/sharp_v3\/css\/steven.css":1}}});
//--><!]]>
</script>
</head>
<body class="html not-front logged-in one-sidebar sidebar-first page-node page-node- page-node-11469 node-type-article" >
  <div id="skip-link">
    <a href="#main-content" class="element-invisible element-focusable">Skip to main content</a>
  </div>
    <div class="page-wrapper">
  <div id="header">
	<div class="container">
		<h1 id="logo"><a href="/zh">QingFan</a></h1>
		<ul class="header-menu" role="menu">
			<li role="presentation"><a href="/zh/project_list">浏览项目</a></li>
			<li role="presentation"><a href="/zh/show_case_list">成果展示</a></li>
			<li role="presentation" class="dropdown">
				<a id="menu-service" href="#" class="dropdown-toggle" data-toggle="dropdown" role="link" aria-haspopup="true" aria-expanded="false">服务引导<span class="caret"></span></a>
				<ul class="dropdown-menu" aria-labelledby="menu-service">
					<li class="menu-title"><a href="/zh/Q_A">查看常见问题</a></li>
					<li><a href="/zh/Q_A">清帆平台是做什么的？</a></li>
					<li><a href="/zh/Q_A">做项目收不收费？有没有报酬？</a></li>
					<li><a href="/zh/Q_A">我可以从项目中获得什么？</a></li>
					<!--
					<li role="separator" class="divider"></li>
					<li class="menu-title"><a href="##"></a></li>
					-->
				</ul>
			</li>
						<li role="presentation" class="dropdown ">
				<a id="user-profile" url="/zh/delete_user_remind" position="1" href="#" class="dropdown-toggle " data-toggle="dropdown" role="link" aria-haspopup="true" aria-expanded="false">
					<img class="avatar" src="http://cdn.qingfan.com/sites/all/themes/sharp/images/default-avatar.png" alt="xuerenlv@163.com&#039;s picture" title="xuerenlv@163.com&#039;s picture" />					<span class="avatar-name">xuerenlv@163.com</span>
					<span class="caret"></span>
				</a>
				<ul class="dropdown-menu" aria-labelledby="user-profile">
					<li><a href="/zh/my_tasks">当前任务</a></li>
					<li><a href="/zh/user/4009">个人信息</a></li>
					<li><a href="/zh/my_certificate_list">项目经历</a></li>
					<li><a href="/zh/my_points">积分兑换</a></li>
										<li class="divider"></li>
					<li><a href="/zh/user/logout">登出</a></li>
				</ul>
							</li>
					</ul>
	</div>
</div>

    <div id="page">
      <div class="container">


            
            <h1 class="title" id="page-title">使用Storm实现实时大数据分析</h1>              <div class="nav nav-tabs">
                  </div>
                          <div class="region region-content">
    
<div id="block-system-main" class="block block-system">

    
  <div class="block-content">
    <div class="row node">
  <div class="col-md-9 node-content content">
    <div class="block block-node">
      <div class="block-header">
	<!--
        <a class="share"></a>
	-->
	<div class="jiathis_style_24x24 share">
                <a class="jiathis_button_qzone"></a>
        <a class="jiathis_button_tsina"></a>
        <a class="jiathis_button_weixin"></a>
                <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
        <!--
        <a class="jiathis_counter_style"></a>
        -->
        </div>
        <script type="text/javascript" src="http://v3.jiathis.com/code/jia.js" charset="utf-8"></script>

        <h4 class="title">使用Storm实现实时大数据分析</h4>
      </div>
      <div class="block-content">
        <div class="field field-name-body field-type-text-with-summary field-label-hidden"><div class="field-items"><div class="field-item even"><div class="summary" style="margin:0px 0px 1.5em;padding:5px 10px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background:#f7f7f7;"><strong>摘要：</strong>随着数据体积的越来越大，实时处理成为了许多机构需要面对的首要挑战。Shruthi Kumar和Siddharth Patankar在Dr.Dobb’s上结合了汽车超速监视，为我们演示了使用Storm进行实时大数据分析。CSDN在此编译、整理。</div>
<div class="con news_content" style="margin:0px 0px 30px;padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;">
<p style="padding:0px;list-style:none;margin-top:0px;margin-bottom:1.5em;"><strong>简单和明了，Storm让大数据分析变得轻松加愉快。</strong></p>
</div>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;">当今世界，公司的日常运营经常会生成TB级别的数据。数据来源囊括了互联网装置可以捕获的任何类型数据，网站、社交媒体、交易型商业数据以及其它商业环境中创建的数据。考虑到数据的生成量，实时处理成为了许多机构需要面对的首要挑战。我们经常用的一个非常有效的开源实时计算工具就是<a target="_blank" href="http://storm-project.net/" style="cursor:pointer;color:#0066cc;text-decoration:none;">Storm</a> —— Twitter开发，通常被比作“实时的Hadoop”。然而Storm远比Hadoop来的简单，因为用它处理大数据不会带来新老技术的交替。</p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;">Shruthi Kumar、Siddharth Patankar共同效力于Infosys，分别从事技术分析和研发工作。本文详述了Storm的使用方法，例子中的项目名称为“超速报警系统（Speeding Alert System）”。我们想实现的功能是：实时分析过往车辆的数据，一旦车辆数据超过预设的临界值 —— 便触发一个trigger并把相关的数据存入数据库。</p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;"><strong>Storm</strong></p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;">对比Hadoop的批处理，Storm是个实时的、分布式以及具备高容错的计算系统。同Hadoop一样Storm也可以处理大批量的数据，然而Storm在保证高可靠性的前提下还可以让处理进行的更加实时；也就是说，所有的信息都会被处理。Storm同样还具备容错和分布计算这些特性，这就让Storm可以扩展到不同的机器上进行大批量的数据处理。他同样还有以下的这些特性：</p>
<ul style="margin:0px 0px 1em 20px;padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;"><li style="margin:0px;padding:0px;list-style:disc;">
<p>易于扩展。对于扩展，你只需要添加机器和改变对应的topology（拓扑）设置。Storm使用Hadoop Zookeeper进行集群协调，这样可以充分的保证大型集群的良好运行。</p>
</li>
<li style="margin:0px;padding:0px;list-style:disc;">
<p>每条信息的处理都可以得到保证。</p>
</li>
<li style="margin:0px;padding:0px;list-style:disc;">
<p>Storm集群管理简易。</p>
</li>
<li style="margin:0px;padding:0px;list-style:disc;">
<p>Storm的容错机能：一旦topology递交，Storm会一直运行它直到topology被废除或者被关闭。而在执行中出现错误时，也会由Storm重新分配任务。</p>
</li>
<li style="margin:0px;padding:0px;list-style:disc;">
<p>尽管通常使用Java，Storm中的topology可以用任何语言设计。</p>
</li>
</ul><p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;">当然为了更好的理解文章，你首先需要安装和设置Storm。需要通过以下几个简单的步骤：</p>
<ul style="margin:0px 0px 1em 20px;padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;"><li style="margin:0px;padding:0px;list-style:disc;">
<p>从Storm官方下载<a target="_blank" href="http://storm-project.net/downloads.html" style="cursor:pointer;color:#0066cc;text-decoration:none;">Storm安装文件</a></p>
</li>
<li style="margin:0px;padding:0px;list-style:disc;">
<p>将bin/directory解压到你的PATH上，并保证bin/storm脚本是可执行的。</p>
</li>
</ul><p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;"><strong>Storm组件</strong></p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;">Storm集群主要由一个主节点和一群工作节点（worker node）组成，通过 Zookeeper进行协调。</p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;"><strong>主节点：</strong></p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;">主节点通常运行一个后台程序 —— Nimbus，用于响应分布在集群中的节点，分配任务和监测故障。这个很类似于Hadoop中的Job Tracker。</p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;"><strong>工作节点：</strong></p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;">工作节点同样会运行一个后台程序 —— Supervisor，用于收听工作指派并基于要求运行工作进程。每个工作节点都是topology中一个子集的实现。而Nimbus和Supervisor之间的协调则通过Zookeeper系统或者集群。</p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;"><strong>Zookeeper</strong></p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;">Zookeeper是完成Supervisor和Nimbus之间协调的服务。而应用程序实现实时的逻辑则被封装进Storm中的“topology”。topology则是一组由Spouts（数据源）和Bolts（数据操作）通过Stream Groupings进行连接的图。下面对出现的术语进行更深刻的解析。</p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;"><strong>Spout：</strong></p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;">简而言之，Spout从来源处读取数据并放入topology。Spout分成可靠和不可靠两种；当Storm接收失败时，可靠的Spout会对tuple（元组，数据项组成的列表）进行重发；而不可靠的Spout不会考虑接收成功与否只发射一次。而Spout中最主要的方法就是nextTuple（），该方法会发射一个新的tuple到topology，如果没有新tuple发射则会简单的返回。</p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;"><strong>Bolt：</strong></p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;">Topology中所有的处理都由Bolt完成。Bolt可以完成任何事，比如：连接的过滤、聚合、访问文件/数据库、等等。Bolt从Spout中接收数据并进行处理，如果遇到复杂流的处理也可能将tuple发送给另一个Bolt进行处理。而Bolt中最重要的方法是execute（），以新的tuple作为参数接收。不管是Spout还是Bolt，如果将tuple发射成多个流，这些流都可以通过declareStream（）来声明。</p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;"><strong>Stream Groupings：</strong></p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;">Stream Grouping定义了一个流在Bolt任务间该如何被切分。这里有<a target="_blank" href="https://github.com/nathanmarz/storm/wiki/Tutorial" style="cursor:pointer;color:#0066cc;text-decoration:none;">Storm提供</a>的6个Stream Grouping类型：</p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;">1. 随机分组（Shuffle grouping）：随机分发tuple到Bolt的任务，保证每个任务获得相等数量的tuple。</p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;">2. 字段分组（Fields grouping）：根据指定字段分割数据流，并分组。例如，根据“user-id”字段，相同“user-id”的元组总是分发到同一个任务，不同“user-id”的元组可能分发到不同的任务。</p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;">3. 全部分组（All grouping）：tuple被复制到bolt的所有任务。这种类型需要谨慎使用。</p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;">4. 全局分组（Global grouping）：全部流都分配到bolt的同一个任务。明确地说，是分配给ID最小的那个task。</p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;">5. 无分组（None grouping）：你不需要关心流是如何分组。目前，无分组等效于随机分组。但最终，Storm将把无分组的Bolts放到Bolts或Spouts订阅它们的同一线程去执行（如果可能）。</p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;">6. 直接分组（Direct grouping）：这是一个特别的分组类型。元组生产者决定tuple由哪个元组处理者任务接收。</p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;">当然还可以实现CustomStreamGroupimg接口来定制自己需要的分组。</p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;"><strong>项目实施</strong></p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;">当下情况我们需要给Spout和Bolt设计一种能够处理大量数据（日志文件）的topology，当一个特定数据值超过预设的临界值时促发警报。使用Storm的topology，逐行读入日志文件并且监视输入数据。在Storm组件方面，Spout负责读入输入数据。它不仅从现有的文件中读入数据，同时还监视着新文件。文件一旦被修改Spout会读入新的版本并且覆盖之前的tuple（可以被Bolt读入的格式），将tuple发射给Bolt进行临界分析，这样就可以发现所有可能超临界的记录。</p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;">下一节将对用例进行详细介绍。</p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;"><strong>临界分析</strong></p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;">这一节，将主要聚焦于临界值的两种分析类型：瞬间临界（instant thershold）和时间序列临界（time series threshold）。</p>
<ul style="margin:0px 0px 1em 20px;padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;"><li style="margin:0px;padding:0px;list-style:disc;">
<p>瞬间临界值监测：一个字段的值在那个瞬间超过了预设的临界值，如果条件符合的话则触发一个trigger。举个例子当车辆超越80公里每小时，则触发trigger。</p>
</li>
<li style="margin:0px;padding:0px;list-style:disc;">
<p>时间序列临界监测：字段的值在一个给定的时间段内超过了预设的临界值，如果条件符合则触发一个触发器。比如：在5分钟类，时速超过80KM两次及以上的车辆。</p>
</li>
</ul><p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;"><strong>Listing One</strong>显示了我们将使用的一个类型日志，其中包含的车辆数据信息有：车牌号、车辆行驶的速度以及数据获取的位置。</p>
<table style="color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;"><tbody><tr><td width="60" style="margin:0px;padding:5px;list-style:none;border:2px solid #dddddd;">AB 123</td>
<td width="60" align="center" style="margin:0px;padding:5px;list-style:none;border:2px solid #dddddd;">60</td>
<td width="120" align="center" style="margin:0px;padding:5px;list-style:none;border:2px solid #dddddd;">North city</td>
</tr><tr><td width="60" style="margin:0px;padding:5px;list-style:none;border:2px solid #dddddd;">BC 123</td>
<td width="60" align="center" style="margin:0px;padding:5px;list-style:none;border:2px solid #dddddd;">70</td>
<td width="120" align="center" style="margin:0px;padding:5px;list-style:none;border:2px solid #dddddd;">South city</td>
</tr><tr><td width="60" style="margin:0px;padding:5px;list-style:none;border:2px solid #dddddd;">CD 234</td>
<td width="60" align="center" style="margin:0px;padding:5px;list-style:none;border:2px solid #dddddd;">40</td>
<td width="120" align="center" style="margin:0px;padding:5px;list-style:none;border:2px solid #dddddd;">South city</td>
</tr><tr><td width="60" style="margin:0px;padding:5px;list-style:none;border:2px solid #dddddd;">DE 123</td>
<td width="60" align="center" style="margin:0px;padding:5px;list-style:none;border:2px solid #dddddd;">40</td>
<td width="120" align="center" style="margin:0px;padding:5px;list-style:none;border:2px solid #dddddd;">East  city</td>
</tr><tr><td width="60" style="margin:0px;padding:5px;list-style:none;border:2px solid #dddddd;">EF 123</td>
<td width="60" align="center" style="margin:0px;padding:5px;list-style:none;border:2px solid #dddddd;">90</td>
<td width="120" align="center" style="margin:0px;padding:5px;list-style:none;border:2px solid #dddddd;">South city</td>
</tr><tr><td width="60" style="margin:0px;padding:5px;list-style:none;border:2px solid #dddddd;">GH 123</td>
<td width="60" align="center" style="margin:0px;padding:5px;list-style:none;border:2px solid #dddddd;">50</td>
<td width="120" align="center" style="margin:0px;padding:5px;list-style:none;border:2px solid #dddddd;">West  city</td>
</tr></tbody></table><p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;">这里将创建一个对应的XML文件，这将包含引入数据的模式。这个XML将用于日志文件的解析。XML的设计模式和对应的说明请见下表。</p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;text-align:center;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;"><img border="0" width="600" height="271" src="http://cms.csdnimg.cn/articlev1/uploads/allimg/121221/164_121221164802_1.jpg" style="vertical-align:middle;border:none;cursor:pointer;" /></p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;">XML文件和日志文件都存放在Spout可以随时监测的目录下，用以关注文件的实时更新。而这个用例中的topology请见下图。</p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;text-align:center;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;"><img border="0" width="600" height="199" src="http://cms.csdnimg.cn/articlev1/uploads/allimg/121221/164_121221164946_1.jpg" style="vertical-align:middle;border:none;cursor:pointer;" /></p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;"><span style="font-size:smaller;"><strong>Figure 1：Storm中建立的topology，用以实现数据实时处理</strong></span></p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;">如图所示：FilelistenerSpout接收输入日志并进行逐行的读入，接着将数据发射给ThresoldCalculatorBolt进行更深一步的临界值处理。一旦处理完成，被计算行的数据将发送给DBWriterBolt，然后由DBWriterBolt存入给数据库。下面将对这个过程的实现进行详细的解析。</p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;"><strong>Spout的实现</strong></p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;">Spout以日志文件和XML描述文件作为接收对象。XML文件包含了与日志一致的设计模式。不妨设想一下一个示例日志文件，包含了车辆的车牌号、行驶速度、以及数据的捕获位置。（看下图）</p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;text-align:center;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;"><img border="0" width="600" height="305" src="http://cms.csdnimg.cn/articlev1/uploads/allimg/121221/164_121221165147_1.gif" style="vertical-align:middle;border:none;cursor:pointer;" /></p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;"><span style="font-size:smaller;"><strong>Figure2：数据从日志文件到Spout的流程图</strong></span></p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;">Listing Two显示了tuple对应的XML，其中指定了字段、将日志文件切割成字段的定界符以及字段的类型。XML文件以及数据都被保存到Spout指定的路径。</p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;"><strong>Listing Two：用以描述日志文件的XML文件。</strong></p>
<pre style="padding:10px;list-style:none;overflow:hidden;border:1px solid #dddddd;color:#333333;font-size:14px;line-height:24px;background:#f7f7f7;margin-top:0px;margin-bottom:1em;"><ol class="dp-xml" style="margin:0px 0px 1px 3em;padding:5px 0px;border-left-width:3px;border-left-style:solid;border-left-color:#146b00;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><span class="tag" style="margin:0px 0px 20px;display:block;color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&lt;</span><span class="tag-name" style="color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">TUPLEINFO</span><span class="tag" style="margin:0px 0px 20px;display:block;color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&gt;</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span></span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span class="tag" style="margin:0px 0px 20px;display:block;color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&lt;</span><span class="tag-name" style="color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">FIELDLIST</span><span class="tag" style="margin:0px 0px 20px;display:block;color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&gt;</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span class="tag" style="margin:0px 0px 20px;display:block;color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&lt;</span><span class="tag-name" style="color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">FIELD</span><span class="tag" style="margin:0px 0px 20px;display:block;color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&gt;</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span class="tag" style="margin:0px 0px 20px;display:block;color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&lt;</span><span class="tag-name" style="color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">COLUMNNAME</span><span class="tag" style="margin:0px 0px 20px;display:block;color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&gt;</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">vehicle_number</span><span class="tag" style="margin:0px 0px 20px;display:block;color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&lt;/</span><span class="tag-name" style="color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">COLUMNNAME</span><span class="tag" style="margin:0px 0px 20px;display:block;color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&gt;</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span class="tag" style="margin:0px 0px 20px;display:block;color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&lt;</span><span class="tag-name" style="color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">COLUMNTYPE</span><span class="tag" style="margin:0px 0px 20px;display:block;color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&gt;</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">string</span><span class="tag" style="margin:0px 0px 20px;display:block;color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&lt;/</span><span class="tag-name" style="color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">COLUMNTYPE</span><span class="tag" style="margin:0px 0px 20px;display:block;color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&gt;</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span class="tag" style="margin:0px 0px 20px;display:block;color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&lt;/</span><span class="tag-name" style="color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">FIELD</span><span class="tag" style="margin:0px 0px 20px;display:block;color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&gt;</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span class="tag" style="margin:0px 0px 20px;display:block;color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&lt;</span><span class="tag-name" style="color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">FIELD</span><span class="tag" style="margin:0px 0px 20px;display:block;color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&gt;</span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span class="tag" style="margin:0px 0px 20px;display:block;color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&lt;</span><span class="tag-name" style="color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">COLUMNNAME</span><span class="tag" style="margin:0px 0px 20px;display:block;color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&gt;</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">speed</span><span class="tag" style="margin:0px 0px 20px;display:block;color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&lt;/</span><span class="tag-name" style="color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">COLUMNNAME</span><span class="tag" style="margin:0px 0px 20px;display:block;color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&gt;</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span class="tag" style="margin:0px 0px 20px;display:block;color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&lt;</span><span class="tag-name" style="color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">COLUMNTYPE</span><span class="tag" style="margin:0px 0px 20px;display:block;color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&gt;</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">int</span><span class="tag" style="margin:0px 0px 20px;display:block;color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&lt;/</span><span class="tag-name" style="color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">COLUMNTYPE</span><span class="tag" style="margin:0px 0px 20px;display:block;color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&gt;</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span class="tag" style="margin:0px 0px 20px;display:block;color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&lt;/</span><span class="tag-name" style="color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">FIELD</span><span class="tag" style="margin:0px 0px 20px;display:block;color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&gt;</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span class="tag" style="margin:0px 0px 20px;display:block;color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&lt;</span><span class="tag-name" style="color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">FIELD</span><span class="tag" style="margin:0px 0px 20px;display:block;color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&gt;</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span class="tag" style="margin:0px 0px 20px;display:block;color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&lt;</span><span class="tag-name" style="color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">COLUMNNAME</span><span class="tag" style="margin:0px 0px 20px;display:block;color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&gt;</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">location</span><span class="tag" style="margin:0px 0px 20px;display:block;color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&lt;/</span><span class="tag-name" style="color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">COLUMNNAME</span><span class="tag" style="margin:0px 0px 20px;display:block;color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&gt;</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span class="tag" style="margin:0px 0px 20px;display:block;color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&lt;</span><span class="tag-name" style="color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">COLUMNTYPE</span><span class="tag" style="margin:0px 0px 20px;display:block;color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&gt;</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">string</span><span class="tag" style="margin:0px 0px 20px;display:block;color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&lt;/</span><span class="tag-name" style="color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">COLUMNTYPE</span><span class="tag" style="margin:0px 0px 20px;display:block;color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&gt;</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span class="tag" style="margin:0px 0px 20px;display:block;color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&lt;/</span><span class="tag-name" style="color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">FIELD</span><span class="tag" style="margin:0px 0px 20px;display:block;color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&gt;</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span class="tag" style="margin:0px 0px 20px;display:block;color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&lt;/</span><span class="tag-name" style="color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">FIELDLIST</span><span class="tag" style="margin:0px 0px 20px;display:block;color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&gt;</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span class="tag" style="margin:0px 0px 20px;display:block;color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&lt;</span><span class="tag-name" style="color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">DELIMITER</span><span class="tag" style="margin:0px 0px 20px;display:block;color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&gt;</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">,</span><span class="tag" style="margin:0px 0px 20px;display:block;color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&lt;/</span><span class="tag-name" style="color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">DELIMITER</span><span class="tag" style="margin:0px 0px 20px;display:block;color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&gt;</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span class="tag" style="margin:0px 0px 20px;display:block;color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&lt;/</span><span class="tag-name" style="color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">TUPLEINFO</span><span class="tag" style="margin:0px 0px 20px;display:block;color:#993300;font-weight:700;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">&gt;</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">   </span></p></li></ol></pre><p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;">通过构造函数及它的参数Directory、PathSpout和TupleInfo对象创建Spout对象。TupleInfo储存了日志文件的字段、定界符、字段的类型这些很必要的信息。这个对象通过<a target="_blank" href="http://xstream.codehaus.org/" style="cursor:pointer;color:#0066cc;text-decoration:none;">XSTream</a>序列化XML时建立。</p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;">Spout的实现步骤：</p>
<ul style="margin:0px 0px 1em 20px;padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;"><li style="margin:0px;padding:0px;list-style:disc;">
<p>对文件的改变进行分开的监听，并监视目录下有无新日志文件添加。</p>
</li>
<li style="margin:0px;padding:0px;list-style:disc;">
<p>在数据得到了字段的说明后，将其转换成tuple。</p>
</li>
<li style="margin:0px;padding:0px;list-style:disc;">
<p>声明Spout和Bolt之间的分组，并决定tuple发送给Bolt的途径。</p>
</li>
</ul><p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;">Spout的具体编码在Listing Three中显示。</p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;"><strong>Listing Three：Spout中open、nextTuple和delcareOutputFields方法的逻辑。</strong></p>
<pre style="padding:10px;list-style:none;overflow:hidden;border:1px solid #dddddd;color:#333333;font-size:14px;line-height:24px;background:#f7f7f7;margin-top:0px;margin-bottom:1em;"><ol class="dp-j" style="margin:0px 0px 1px 3em;padding:5px 0px;border-left-width:3px;border-left-style:solid;border-left-color:#146b00;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">public</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">void</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> open( Map conf, TopologyContext context,SpoutOutputCollector collector )   </span></span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">{   </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">           _collector = collector;   </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">         </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">try</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">   </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">         {   </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">         fileReader  =  </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">new</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> BufferedReader(</span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">new</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> FileReader(</span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">new</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> File(file)));  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">         }  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">         </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">catch</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> (FileNotFoundException e)  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">         {  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">         System.exit(</span><span class="number" style="color:#c00000;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">1</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">);   </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">         }  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">}                                                          </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">public</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">void</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> nextTuple()  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">{  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">         </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">protected</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">void</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> ListenFile(File file)  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">         {  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">         Utils.sleep(</span><span class="number" style="color:#c00000;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">2000</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">);  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">         RandomAccessFile access = </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">null</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">;  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">         String line = </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">null</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">;   </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">            </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">try</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">   </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">            {  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">while</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> ((line = access.readLine()) != </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">null</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">)  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                {  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                    </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">if</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> (line !=</span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">null</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">)  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                    {   </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                         String[] fields=</span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">null</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">;  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                          </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">if</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> (tupleInfo.getDelimiter().equals(</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"|"</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">))  fields = line.split(</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"\\"</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">+tupleInfo.getDelimiter());   </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                          </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">else</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">   </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                          fields = line.split  (tupleInfo.getDelimiter());   </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                          </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">if</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> (tupleInfo.getFieldList().size() == fields.length)  _collector.emit(</span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">new</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> Values(fields));  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                    }  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">               }  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">            }  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">            </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">catch</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> (IOException ex){ }  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">            }  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">}  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">public</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">void</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> declareOutputFields(OutputFieldsDeclarer declarer)  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">{  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">      String[] fieldsArr = </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">new</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> String [tupleInfo.getFieldList().size()];  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">      </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">for</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">(</span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">int</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> i=</span><span class="number" style="color:#c00000;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">0</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">; i&lt;tupleInfo.getFieldList().size(); i++)  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">      {  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">              fieldsArr[i] = tupleInfo.getFieldList().get(i).getColumnName();  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">      }  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">declarer.declare(</span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">new</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> Fields(fieldsArr));  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">}      </span></p></li></ol></pre><p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;">declareOutputFileds（）决定了tuple发射的格式，这样的话Bolt就可以用类似的方法将tuple译码。Spout持续对日志文件的数据的变更进行监听，一旦有添加Spout就会进行读入并且发送给Bolt进行处理。</p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;"><strong>Bolt的实现</strong></p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;">Spout的输出结果将给予Bolt进行更深一步的处理。经过对用例的思考，我们的topology中需要如Figure 3中的两个Bolt。</p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;"><strong>Figure 3：Spout到Bolt的数据流程。</strong></p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;"><strong>ThresholdCalculatorBolt</strong></p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;">Spout将tuple发出，由ThresholdCalculatorBolt接收并进行临界值处理。在这里，它将接收好几项输入进行检查；分别是：</p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;">临界值检查</p>
<ul style="margin:0px 0px 1em 20px;padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;"><li style="margin:0px;padding:0px;list-style:disc;">
<p>临界值栏数检查（拆分成字段的数目）</p>
</li>
<li style="margin:0px;padding:0px;list-style:disc;">
<p>临界值数据类型（拆分后字段的类型）</p>
</li>
<li style="margin:0px;padding:0px;list-style:disc;">
<p>临界值出现的频数</p>
</li>
<li style="margin:0px;padding:0px;list-style:disc;">
<p>临界值时间段检查</p>
</li>
</ul><p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;">Listing Four中的类，定义用来保存这些值。</p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;"><strong>Listing Four:ThresholdInfo类</strong></p>
<pre style="padding:10px;list-style:none;overflow:hidden;border:1px solid #dddddd;color:#333333;font-size:14px;line-height:24px;background:#f7f7f7;margin-top:0px;margin-bottom:1em;"><ol class="dp-xml" style="margin:0px 0px 1px 3em;padding:5px 0px;border-left-width:3px;border-left-style:solid;border-left-color:#146b00;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">public class ThresholdInfo implementsSerializable  </span></span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">{    </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">        private String action;   </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">        private String rule;   </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">        private Object thresholdValue;  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">        private int thresholdColNumber;   </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">        private Integer timeWindow;   </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">        private int frequencyOfOccurence;   </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">}   </span></p></li></ol></pre><p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;">基于字段中提供的值，临界值检查将被Listing Five中的execute（）方法执行。代码大部分的功能是解析和接收值的检测。</p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;"><strong>Listing Five：临界值检测代码段</strong></p>
<pre style="padding:10px;list-style:none;overflow:hidden;border:1px solid #dddddd;color:#333333;font-size:14px;line-height:24px;background:#f7f7f7;margin-top:0px;margin-bottom:1em;"><ol class="dp-j" style="margin:0px 0px 1px 3em;padding:5px 0px;border-left-width:3px;border-left-style:solid;border-left-color:#146b00;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">public</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">void</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> execute(Tuple tuple, BasicOutputCollector collector)   </span></span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">{  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">    </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">if</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">(tuple!=</span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">null</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">)   </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">    {  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">        List&lt;Object&gt; inputTupleList = (List&lt;Object&gt;) tuple.getValues();  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">        </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">int</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> thresholdColNum = thresholdInfo.getThresholdColNumber();   </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">        Object thresholdValue = thresholdInfo.getThresholdValue();   </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">        String thresholdDataType = tupleInfo.getFieldList().get(thresholdColNum-</span><span class="number" style="color:#c00000;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">1</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">).getColumnType();   </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">        Integer timeWindow = thresholdInfo.getTimeWindow();  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">         </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">int</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> frequency = thresholdInfo.getFrequencyOfOccurence();  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">         </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">if</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">(thresholdDataType.equalsIgnoreCase(</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"string"</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">))  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">         {  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">             String valueToCheck = inputTupleList.get(thresholdColNum-</span><span class="number" style="color:#c00000;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">1</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">).toString();  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">             String frequencyChkOp = thresholdInfo.getAction();  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">             </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">if</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">(timeWindow!=</span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">null</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">)  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">             {  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                 </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">long</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> curTime = System.currentTimeMillis();  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                 </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">long</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> diffInMinutes = (curTime-startTime)/(</span><span class="number" style="color:#c00000;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">1000</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">);  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                 </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">if</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">(diffInMinutes&gt;=timeWindow)  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                 {  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                     </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">if</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">(frequencyChkOp.equals(</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"=="</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">))  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                     {  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                          </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">if</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">(valueToCheck.equalsIgnoreCase(thresholdValue.toString()))  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                          {  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                              count.incrementAndGet();  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                              </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">if</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">(count.get() &gt; frequency)  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                                  splitAndEmit(inputTupleList,collector);  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                          }  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                     }  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                     </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">else</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">if</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">(frequencyChkOp.equals(</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"!="</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">))  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                     {  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                         </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">if</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">(!valueToCheck.equalsIgnoreCase(thresholdValue.toString()))  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                         {  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                              count.incrementAndGet();  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                              </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">if</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">(count.get() &gt; frequency)  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                                  splitAndEmit(inputTupleList,collector);  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                          }  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                      }  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                      </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">else</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                         System.out.println(</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"Operator not supported"</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">);   </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                  }  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">              }  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">              </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">else</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">              {  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                  </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">if</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">(frequencyChkOp.equals(</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"=="</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">))  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                  {  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                      </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">if</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">(valueToCheck.equalsIgnoreCase(thresholdValue.toString()))  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                      {  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                          count.incrementAndGet();  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                          </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">if</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">(count.get() &gt; frequency)  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                              splitAndEmit(inputTupleList,collector);  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                          }  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                  }  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                  </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">else</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">if</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">(frequencyChkOp.equals(</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"!="</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">))  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                  {  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                       </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">if</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">(!valueToCheck.equalsIgnoreCase(thresholdValue.toString()))  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                       {  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                           count.incrementAndGet();  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                           </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">if</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">(count.get() &gt; frequency)  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                               splitAndEmit(inputTupleList,collector);  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                          }  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                   }  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">               }  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">            }  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">            </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">else</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">if</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">(thresholdDataType.equalsIgnoreCase(</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"int"</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">) ||                     thresholdDataType.equalsIgnoreCase(</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"double"</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">) ||                     thresholdDataType.equalsIgnoreCase(</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"float"</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">) ||                     thresholdDataType.equalsIgnoreCase(</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"long"</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">) ||                     thresholdDataType.equalsIgnoreCase(</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"short"</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">))  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">            {  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                String frequencyChkOp = thresholdInfo.getAction();  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">if</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">(timeWindow!=</span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">null</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">)  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                {  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                     </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">long</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> valueToCheck =                          Long.parseLong(inputTupleList.get(thresholdColNum-</span><span class="number" style="color:#c00000;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">1</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">).toString());  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                     </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">long</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> curTime = System.currentTimeMillis();  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                     </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">long</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> diffInMinutes = (curTime-startTime)/(</span><span class="number" style="color:#c00000;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">1000</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">);  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                     System.out.println(</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"Difference in minutes="</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">+diffInMinutes);  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                     </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">if</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">(diffInMinutes&gt;=timeWindow)  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                     {  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                          </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">if</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">(frequencyChkOp.equals(</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"&lt;"</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">))  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                          {  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                              </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">if</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">(valueToCheck &lt; Double.parseDouble(thresholdValue.toString()))  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                              {  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                                   count.incrementAndGet();  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                                   </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">if</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">(count.get() &gt; frequency)  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                                       splitAndEmit(inputTupleList,collector);  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                              }  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                          }  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                          </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">else</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">if</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">(frequencyChkOp.equals(</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"&gt;"</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">))  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                          {  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                               </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">if</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">(valueToCheck &gt; Double.parseDouble(thresholdValue.toString()))  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                                {  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                                   count.incrementAndGet();  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                                   </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">if</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">(count.get() &gt; frequency)  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                                       splitAndEmit(inputTupleList,collector);  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                               }  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                           }  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                           </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">else</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">if</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">(frequencyChkOp.equals(</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"=="</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">))  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                           {  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                              </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">if</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">(valueToCheck == Double.parseDouble(thresholdValue.toString()))  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                              {  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                                  count.incrementAndGet();  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                                  </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">if</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">(count.get() &gt; frequency)  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                                      splitAndEmit(inputTupleList,collector);  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                               }  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                           }  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                           </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">else</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">if</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">(frequencyChkOp.equals(</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"!="</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">))  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                           {  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">    . . .  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                            }  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                       }  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">             }  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">      </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">else</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">          splitAndEmit(</span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">null</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">,collector);  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">      }  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">      </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">else</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">     {  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">           System.err.println(</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"Emitting null in bolt"</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">);  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">           splitAndEmit(</span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">null</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">,collector);  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">    }  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">} </span></p></li></ol></pre><p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;">经由Bolt发送的的tuple将会传递到下一个对应的Bolt，在我们的用例中是DBWriterBolt。</p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;"><strong>DBWriterBolt</strong></p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;">经过处理的tuple必须被持久化以便于触发tigger或者更深层次的使用。DBWiterBolt做了这个持久化的工作并把tuple存入了数据库。表的建立由prepare（）函数完成，这也将是topology调用的第一个方法。方法的编码如Listing Six所示。</p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;"><strong>Listing Six：建表编码。</strong></p>
<pre style="padding:10px;list-style:none;overflow:hidden;border:1px solid #dddddd;color:#333333;font-size:14px;line-height:24px;background:#f7f7f7;margin-top:0px;margin-bottom:1em;"><ol class="dp-j" style="margin:0px 0px 1px 3em;padding:5px 0px;border-left-width:3px;border-left-style:solid;border-left-color:#146b00;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">public</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">void</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> prepare( Map StormConf, TopologyContext context )   </span></span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">{         </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">    </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">try</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">   </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">    {  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">        Class.forName(dbClass);  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">    }   </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">    </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">catch</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> (ClassNotFoundException e)   </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">    {  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">        System.out.println(</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"Driver not found"</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">);  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">        e.printStackTrace();  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">    }  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">   </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">    </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">try</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">   </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">    {  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">       connection driverManager.getConnection(   </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">           </span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"jdbc:mysql://"</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">+databaseIP+</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">":"</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">+databasePort+</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"/"</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">+databaseName, userName, pwd);  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">       connection.prepareStatement(</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"DROP TABLE IF EXISTS "</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">+tableName).execute();  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">   </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">       StringBuilder createQuery = </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">new</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> StringBuilder(  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">           </span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"CREATE TABLE IF NOT EXISTS "</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">+tableName+</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"("</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">);  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">       </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">for</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">(Field fields : tupleInfo.getFieldList())  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">       {  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">           </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">if</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">(fields.getColumnType().equalsIgnoreCase(</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"String"</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">))  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">               createQuery.append(fields.getColumnName()+</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">" VARCHAR(500),"</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">);  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">           </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">else</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">               createQuery.append(fields.getColumnName()+</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">" "</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">+fields.getColumnType()+</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">","</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">);  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">       }  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">       createQuery.append(</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"thresholdTimeStamp timestamp)"</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">);  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">       connection.prepareStatement(createQuery.toString()).execute();  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">   </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">       </span><span class="comment" style="color:#008200;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">// Insert Query </span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">       StringBuilder insertQuery = </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">new</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> StringBuilder(</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"INSERT INTO "</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">+tableName+</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"("</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">);  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">       String tempCreateQuery = </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">new</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> String();  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">       </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">for</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">(Field fields : tupleInfo.getFieldList())  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">       {  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">            insertQuery.append(fields.getColumnName()+</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">","</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">);  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">       }  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">       insertQuery.append(</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"thresholdTimeStamp"</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">).append(</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">") values ("</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">);  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">       </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">for</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">(Field fields : tupleInfo.getFieldList())  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">       {  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">           insertQuery.append(</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"?,"</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">);  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">       }  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">   </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">       insertQuery.append(</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"?)"</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">);  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">       prepStatement = connection.prepareStatement(insertQuery.toString());  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">    }  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">    </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">catch</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> (SQLException e)   </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">    {         </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">        e.printStackTrace();  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">    }         </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">}  </span></p></li></ol></pre><p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;">数据分批次的插入数据库。插入的逻辑由Listting Seven中的execute（）方法提供。大部分的编码都是用来实现可能存在不同类型输入的解析。</p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;"><strong>Listing Seven：数据插入的代码部分。</strong></p>
<pre style="padding:10px;list-style:none;overflow:hidden;border:1px solid #dddddd;color:#333333;font-size:14px;line-height:24px;background:#f7f7f7;margin-top:0px;margin-bottom:1em;"><ol class="dp-j" style="margin:0px 0px 1px 3em;padding:5px 0px;border-left-width:3px;border-left-style:solid;border-left-color:#146b00;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">public</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">void</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> execute(Tuple tuple, BasicOutputCollector collector)   </span></span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">{  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">    batchExecuted=</span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">false</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">;  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">    </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">if</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">(tuple!=</span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">null</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">)  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">    {  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">       List&amp;#</span><span class="number" style="color:#c00000;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">60</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">;Object&amp;#</span><span class="number" style="color:#c00000;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">62</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">; inputTupleList = (List&amp;#</span><span class="number" style="color:#c00000;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">60</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">;Object&amp;#</span><span class="number" style="color:#c00000;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">62</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">;) tuple.getValues();  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">       </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">int</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> dbIndex=</span><span class="number" style="color:#c00000;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">0</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">;  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">       </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">for</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">(</span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">int</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> i=</span><span class="number" style="color:#c00000;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">0</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">;i&amp;#</span><span class="number" style="color:#c00000;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">60</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">;tupleInfo.getFieldList().size();i++)  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">       {  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">           Field field = tupleInfo.getFieldList().get(i);  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">           </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">try</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> {  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">               dbIndex = i+</span><span class="number" style="color:#c00000;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">1</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">;  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">               </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">if</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">(field.getColumnType().equalsIgnoreCase(</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"String"</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">))               </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                   prepStatement.setString(dbIndex, inputTupleList.get(i).toString());  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">               </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">else</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">if</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">(field.getColumnType().equalsIgnoreCase(</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"int"</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">))  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                   prepStatement.setInt(dbIndex,  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                       Integer.parseInt(inputTupleList.get(i).toString()));  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">               </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">else</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">if</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">(field.getColumnType().equalsIgnoreCase(</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"long"</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">))  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                   prepStatement.setLong(dbIndex,   </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                       Long.parseLong(inputTupleList.get(i).toString()));  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">               </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">else</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">if</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">(field.getColumnType().equalsIgnoreCase(</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"float"</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">))  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                   prepStatement.setFloat(dbIndex,   </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                       Float.parseFloat(inputTupleList.get(i).toString()));  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">               </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">else</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">if</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">(field.getColumnType().equalsIgnoreCase(</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"double"</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">))  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                   prepStatement.setDouble(dbIndex,   </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                       Double.parseDouble(inputTupleList.get(i).toString()));  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">               </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">else</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">if</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">(field.getColumnType().equalsIgnoreCase(</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"short"</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">))  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                   prepStatement.setShort(dbIndex,   </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                       Short.parseShort(inputTupleList.get(i).toString()));  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">               </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">else</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">if</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">(field.getColumnType().equalsIgnoreCase(</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"boolean"</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">))  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                   prepStatement.setBoolean(dbIndex,   </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                       Boolean.parseBoolean(inputTupleList.get(i).toString()));  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">               </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">else</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">if</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">(field.getColumnType().equalsIgnoreCase(</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"byte"</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">))  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                   prepStatement.setByte(dbIndex,   </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                       Byte.parseByte(inputTupleList.get(i).toString()));  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">               </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">else</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">if</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">(field.getColumnType().equalsIgnoreCase(</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"Date"</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">))  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">               {  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                  Date dateToAdd=</span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">null</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">;  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                  </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">if</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> (!(inputTupleList.get(i) </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">instanceof</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> Date))    </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                  {    </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                       DateFormat df = </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">new</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> SimpleDateFormat(</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"yyyy-MM-dd hh:mm:ss"</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">);  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                       </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">try</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">   </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                       {  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                           dateToAdd = df.parse(inputTupleList.get(i).toString());  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                       }  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                       </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">catch</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> (ParseException e)   </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                       {  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                           System.err.println(</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"Data type not valid"</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">);  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                       }  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                   }    </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                   </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">else</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                   {  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">            dateToAdd = (Date)inputTupleList.get(i);  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">            java.sql.Date sqlDate = </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">new</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> java.sql.Date(dateToAdd.getTime());  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">            prepStatement.setDate(dbIndex, sqlDate);  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">            }     </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">            }   </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">        </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">catch</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> (SQLException e)   </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">        {  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">             e.printStackTrace();  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">        }  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">    }  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">    Date now = </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">new</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> Date();            </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">    </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">try</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">    {  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">        prepStatement.setTimestamp(dbIndex+</span><span class="number" style="color:#c00000;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">1</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">, </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">new</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> java.sql.Timestamp(now.getTime()));  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">        prepStatement.addBatch();  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">        counter.incrementAndGet();  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">        </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">if</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> (counter.get()== batchSize)   </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">        executeBatch();  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">    }   </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">    </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">catch</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> (SQLException e1)   </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">    {  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">        e1.printStackTrace();  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">    }             </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">   }  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">   </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">else</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">   {  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">        </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">long</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> curTime = System.currentTimeMillis();  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">       </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">long</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> diffInSeconds = (curTime-startTime)/(</span><span class="number" style="color:#c00000;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">60</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">*</span><span class="number" style="color:#c00000;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">1000</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">);  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">       </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">if</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">(counter.get()&amp;#</span><span class="number" style="color:#c00000;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">60</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">;batchSize &amp;&amp; diffInSeconds&amp;#</span><span class="number" style="color:#c00000;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">62</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">;batchTimeWindowInSeconds)  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">       {  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">            </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">try</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> {  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                executeBatch();  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                startTime = System.currentTimeMillis();  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">            }  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">            </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">catch</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> (SQLException e) {  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                 e.printStackTrace();  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">            }  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">       }  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">   }  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">}  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">   </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">public</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">void</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> executeBatch() </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">throws</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> SQLException  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">{  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">    batchExecuted=</span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">true</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">;  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">    prepStatement.executeBatch();  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">    counter = </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">new</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> AtomicInteger(</span><span class="number" style="color:#c00000;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">0</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">);  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">} </span></p></li></ol></pre><p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;">一旦Spout和Bolt准备就绪（等待被执行），topology生成器将会建立topology并准备执行。下面就来看一下执行步骤。</p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;"><strong>在本地集群上运行和测试topology</strong></p>
<ul style="margin:0px 0px 1em 20px;padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;"><li style="margin:0px;padding:0px;list-style:disc;">
<p>通过TopologyBuilder建立topology。</p>
</li>
<li style="margin:0px;padding:0px;list-style:disc;">
<p>使用Storm Submitter，将topology递交给集群。以topology的名字、配置和topology的对象作为参数。</p>
</li>
<li style="margin:0px;padding:0px;list-style:disc;">
<p>提交topology。</p>
</li>
</ul><p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;"><strong>Listing Eight：建立和执行topology。</strong></p>
<pre style="padding:10px;list-style:none;overflow:hidden;border:1px solid #dddddd;color:#333333;font-size:14px;line-height:24px;background:#f7f7f7;margin-top:0px;margin-bottom:1em;"><ol class="dp-j" style="margin:0px 0px 1px 3em;padding:5px 0px;border-left-width:3px;border-left-style:solid;border-left-color:#146b00;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">public</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">class</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> StormMain  </span></span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">{  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">     </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">public</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">static</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">void</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> main(String[] args) </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">throws</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> AlreadyAliveException,   </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                                                   InvalidTopologyException,   </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                                                   InterruptedException   </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">     {  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">          ParallelFileSpout parallelFileSpout = </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">new</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> ParallelFileSpout();  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">          ThresholdBolt thresholdBolt = </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">new</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> ThresholdBolt();  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">          DBWriterBolt dbWriterBolt = </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">new</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> DBWriterBolt();  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">          TopologyBuilder builder = </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">new</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> TopologyBuilder();  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">          builder.setSpout(</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"spout"</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">, parallelFileSpout, </span><span class="number" style="color:#c00000;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">1</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">);  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">          builder.setBolt(</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"thresholdBolt"</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">, thresholdBolt,</span><span class="number" style="color:#c00000;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">1</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">).shuffleGrouping(</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"spout"</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">);  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">          builder.setBolt(</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"dbWriterBolt"</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">,dbWriterBolt,</span><span class="number" style="color:#c00000;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">1</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">).shuffleGrouping(</span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"thresholdBolt"</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">);  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">          </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">if</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">(</span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">this</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">.argsMain!=</span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">null</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> &amp;&amp; </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">this</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">.argsMain.length &amp;#</span><span class="number" style="color:#c00000;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">62</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">; </span><span class="number" style="color:#c00000;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">0</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">)   </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">          {  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">              conf.setNumWorkers(</span><span class="number" style="color:#c00000;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">1</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">);  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">              StormSubmitter.submitTopology(   </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">                   </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">this</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">.argsMain[</span><span class="number" style="color:#c00000;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">0</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">], conf, builder.createTopology());  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">          }  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">          </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">else</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">          {      </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">              Config conf = </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">new</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> Config();  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">              conf.setDebug(</span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">true</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">);  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">              conf.setMaxTaskParallelism(</span><span class="number" style="color:#c00000;background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">3</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">);  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">              LocalCluster cluster = </span><span class="keyword" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">new</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;"> LocalCluster();  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">              cluster.submitTopology(  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">              </span><span class="string" style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">"Threshold_Test"</span><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">, conf, builder.createTopology());  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">          }  </span></p></li><li class="alt" style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:inherit;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">     }  </span></p></li><li style="margin:0px;padding:0px 3px 0px 10px;list-style:decimal;color:#5c5c5c;background:#ffffff;"><p><span style="background-image:initial;background-attachment:initial;background-size:initial;background-origin:initial;background-clip:initial;background-position:initial;background-repeat:initial;">} </span></p></li></ol></pre><p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;">topology被建立后将被提交到本地集群。一旦topology被提交，除非被取缔或者集群关闭，它将一直保持运行不需要做任何的修改。这也是Storm的另一大特色之一。</p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;">这个简单的例子体现了当你掌握了topology、spout和bolt的概念，将可以轻松的使用Storm进行实时处理。如果你既想处理大数据又不想遍历Hadoop的话，不难发现使用Storm将是个很好的选择。</p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;">原文链接：<a target="_blank" href="http://www.drdobbs.com/cloud/easy-real-time-big-data-analysis-using-s/240143874?pgno=1" style="cursor:pointer;color:#0066cc;text-decoration:none;">Easy, Real-Time Big Data Analysis Using Storm</a> （编译/仲浩 王旭东/审校）</p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;">欢迎关注<a target="_blank" href="http://e.weibo.com/csdncloud?ref=http%3A%2F%2Fweibo.com%2F1941615602%2Ffollow%3Ft%3D1%26gid%3D3487295028145536%26page%3D2" style="cursor:pointer;color:#0066cc;text-decoration:none;">@CSDN云计算</a>微博，了解更多云信息。</p>
<p style="padding:0px;list-style:none;color:#333333;font-family:helvetica, tahoma, arial, sans-serif;font-size:14px;line-height:24px;background-color:#ffffff;margin-top:0px;margin-bottom:1.5em;"><strong>本文为CSDN编译整理，未经允许不得转载。如需转载请联系</strong><strong style="cursor:pointer;color:#0066CC;text-decoration:none;"><a href="mailto:market@csdn.net" style="cursor:pointer;color:#0066cc;text-decoration:none;">market@csdn.net</a></strong></p>
</div></div></div>      </div>
    </div>
  </div>
  <div class="sidebar node-sidebar col-md-3">
    <div class="block block-webchat">
      <div class="block-header">
        <h4 class="title">微信关注</h4>
      </div>
      <div class="block-content">
        <div class="media">
          <div class="media-left">
            <img width="105" height="105" src="http://cdn.qingfan.com/sites/all/themes/sharp_v3/images/weixin.jpg" alt="" />          </div>
          <div class="media-body">
	                  <div>咨询项目疑惑</div>
              <div>获取最新动态</div>
	              </div>
        </div>
      </div>
    </div>
  </div>
</div>
  </div>
</div>
  </div>

      </div>
    </div>


  <!-- </div> -->
  <!-- layout need html -->
  <div id="push"></div>

</div>


<div id="footer">
	<div class="container">
		<div class="table">
			<div id="footer-logo" class="table-cell"><a href="##">Qingfan</a></div>
			<div class="footer-sidebar media table-cell">
				<div class="media-object"><img width="114" height="114" src="http://cdn.qingfan.com/sites/all/themes/sharp_v3/images/qr-code.jpg" alt="" /> <p>微信关注</p></div>
				<div class="media-content">
					<ul class="footer-menu">
						<li><a href="/zh/about_us">关于我们</a></li>
						<li><a href="/zh/page/recruit">招募新人</a></li>
						<li><a href="/zh/page/contact">联系我们</a></li>
						<li><a href="/zh/page/terms">隐私条款</a></li>
						<li><a href="http://www.qingfan.com/en">English</a></li>
					</ul>
					<div class="copyright">© 2014-2015 京ICP备 14047177</div>
				</div>
			</div>
		</div>
	</div>
</div>
   </body>
<!--
<script>
window.ppSettings = {
    //appKey，必填字段
    app_key: "1f5a42f3-8907-11e5-b366-58b035f16bf4",
    //appSecret，必填字段
    app_secret: "2061e31e-8907-11e5-ad07-58b035f16bf4"
};
(function(){var w=window,d=document;function l(){var a=d.createElement("script");a.type="text/javascript";a.async=!0;a.src="https://ppmessage.cn/ppcom/assets/pp-library.min.js";var b=d.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)}w.attachEvent?w.attachEvent("onload",l):w.addEventListener("load",l,!1);})()</script>
-->
<script type='text/javascript'>
     /**
     * [美洽网站插件初始化成功了]
     */
        function handleAllSet() {
        // 传递顾客信息
        _MEIQIA._SENDMETADATA({
            name: '薛洪见', // 美洽默认字段
            comment: 'uid:4009', // 美洽默认字段
            email: 'xuerenlv@163.com', // 自定义字段
            tel: '18115473872', // 自定义字段
        });
    }
        (function(m, ei, q, i, a, j, s) {
        m[a] = m[a] || function() {
            (m[a].a = m[a].a || []).push(arguments)
        };
        j = ei.createElement(q),
            s = ei.getElementsByTagName(q)[0];
        j.async = true;
        j.charset = 'UTF-8';
        j.src = i;
        s.parentNode.insertBefore(j, s)
    })(window, document, 'script', '//eco-api.meiqia.com/dist/meiqia.js', '_MEIQIA');
    _MEIQIA('entId', 4832);
    // 初始化成功时的回调
        _MEIQIA('allSet', handleAllSet);
    </script>

<script type='text/javascript'>
      var _vds = _vds || [];
      window._vds = _vds;
      (function(){
        _vds.push(['setAccountId', 'd5ed954c209e4bbaab24945492697371']);
        (function() {
          var vds = document.createElement('script');
          vds.type='text/javascript';
          vds.async = true;
          vds.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'dn-growing.qbox.me/vds.js';
          var s = document.getElementsByTagName('script')[0];
          s.parentNode.insertBefore(vds, s);
        })();
      })();
  </script>
